services:
  audiooook_web:
    build: .
    container_name: audiooook_web
    ports:
      - "3001:4001"
    volumes:
      # 有声书默认存放目录（宿主机 → 容器，用户上传的文件也保存在这里）
      - /data/audiooook_web:/data/audiooook_web

      # 如需额外挂载已有的有声书目录，取消注释并修改：
      # - /nas:/nas
      # - /mnt/media:/mnt/media

      # 持久化服务端数据（配置、元数据、用户数据、封面等）
      - ./data:/app/server/data
    environment:
      - NODE_ENV=production
      - AUDIOBOOK_PATH=/data/audiooook_web
      - PORT=4001
      # 阿里云OSS配置（可选）
      # - OSS_REGION=oss-cn-hangzhou
      # - OSS_ACCESS_KEY_ID=your_access_key_id
      # - OSS_ACCESS_KEY_SECRET=your_access_key_secret
      # - OSS_BUCKET=your_bucket_name
      # - OSS_PREFIX=audiobooks/
    restart: unless-stopped
